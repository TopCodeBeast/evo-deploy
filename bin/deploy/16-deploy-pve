#!/usr/bin/env bash

set -e

. $(PWD)/bin/init

lib="pve"

sig="initialize(address)"
PVETEAM_PROXY=$(deployProxy "$lib" src/proxy/PveTeamProxy.sol:PveTeamProxy src/PveTeam.sol:PveTeam "$sig" "$SETTINGSREGISTRY")

wards=$(loadAuthConf ".pve.team.wards | .[]")
sigs=$(loadAuthConf ".pve.team.sigs | .[]")
PVETEAM_AUTHORITY=$(dappAuth "PveEntry" common-contracts contracts/Authority.sol:Authority "$wards" "$sigs")
setAuth "$PVETEAM_PROXY" "$PVETEAM_AUTHORITY"

seth send "$TOKENUSE_AUTHORITY" "rely(address)" "$PVETEAM_PROXY"

# register "addr" "CONTRACT_TEAM_ENTRY" "$PVETEAM_PROXY"
