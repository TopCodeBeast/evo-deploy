#!/usr/bin/env bash

set -e

. $(PWD)/bin/init

REVENUEPOOLV2=$(dapp create RevenuePoolV2)
seth send $REVENUEPOOL_PROXY "upgradeTo(address)" $REVENUEPOOLV2  
if test $(seth call $REVENUEPOOL_PROXY "implementation()(address)") != $REVENUEPOOLV2; then
  (echo "check migration failed."; exit 1;)
fi
addAddress "REVENUEPOOLV2" "$REVENUEPOOLV2"
echo >&2 "${0##*/}: info: migration finished." 
